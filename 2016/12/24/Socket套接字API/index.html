<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Socket套接字API | MingleChang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="###IPv4套接字地址结构1234567891011121314151617#include &amp;lt;netinet/in.h&amp;gt;/* * Internet address (a structure for historical reasons) */struct in_addr &amp;#123;    in_addr_t s_addr;&amp;#125;;/* * Socket address, i">
<meta property="og:type" content="article">
<meta property="og:title" content="Socket套接字API">
<meta property="og:url" content="http://yoursite.com/2016/12/24/Socket套接字API/index.html">
<meta property="og:site_name" content="MingleChang">
<meta property="og:description" content="###IPv4套接字地址结构1234567891011121314151617#include &amp;lt;netinet/in.h&amp;gt;/* * Internet address (a structure for historical reasons) */struct in_addr &amp;#123;    in_addr_t s_addr;&amp;#125;;/* * Socket address, i">
<meta property="og:updated_time" content="2016-12-24T04:00:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Socket套接字API">
<meta name="twitter:description" content="###IPv4套接字地址结构1234567891011121314151617#include &amp;lt;netinet/in.h&amp;gt;/* * Internet address (a structure for historical reasons) */struct in_addr &amp;#123;    in_addr_t s_addr;&amp;#125;;/* * Socket address, i">
  
    <link rel="alternate" href="/atom.xml" title="MingleChang" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">MingleChang</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Socket套接字API" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/24/Socket套接字API/" class="article-date">
  <time datetime="2016-12-24T03:52:12.000Z" itemprop="datePublished">2016-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Socket套接字API
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###IPv4套接字地址结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#include &lt;netinet/in.h&gt;</div><div class="line">/*</div><div class="line"> * Internet address (a structure for historical reasons)</div><div class="line"> */</div><div class="line">struct in_addr &#123;</div><div class="line">    in_addr_t s_addr;</div><div class="line">&#125;;</div><div class="line">/*</div><div class="line"> * Socket address, internet style.</div><div class="line"> */</div><div class="line">struct sockaddr_in &#123;</div><div class="line">    __uint8_t	sin_len;</div><div class="line">    sa_family_t	sin_family;</div><div class="line">    in_port_t	sin_port;</div><div class="line">    struct	in_addr sin_addr;</div><div class="line">    char		sin_zero[8];</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>###IPv6套接字地址结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">#include &lt;netinet6/in6.h&gt;</div><div class="line">/*</div><div class="line"> * IPv6 address</div><div class="line"> */</div><div class="line">struct in6_addr &#123;</div><div class="line">    union &#123;</div><div class="line">        __uint8_t   __u6_addr8[16];</div><div class="line">        __uint16_t  __u6_addr16[8];</div><div class="line">        __uint32_t  __u6_addr32[4];</div><div class="line">    &#125; __u6_addr;			/* 128-bit IP6 address */</div><div class="line">&#125;;</div><div class="line">struct sockaddr_in6 &#123;</div><div class="line">    __uint8_t	sin6_len;	/* length of this struct(sa_family_t) */</div><div class="line">    sa_family_t	sin6_family;	/* AF_INET6 (sa_family_t) */</div><div class="line">    in_port_t	sin6_port;	/* Transport layer port # (in_port_t) */</div><div class="line">    __uint32_t	sin6_flowinfo;	/* IP6 flow information */</div><div class="line">    struct in6_addr	sin6_addr;	/* IP6 address */</div><div class="line">    __uint32_t	sin6_scope_id;	/* scope zone index */</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>###通用套接字地址结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#include &lt;sys/socket.h&gt;</div><div class="line">/*</div><div class="line"> * [XSI] Structure used by kernel to store most addresses.</div><div class="line"> */</div><div class="line">struct sockaddr &#123;</div><div class="line">    __uint8_t	sa_len;		/* total length */</div><div class="line">    sa_family_t	sa_family;	/* [XSI] address family */</div><div class="line">    char		sa_data[14];	/* [XSI] addr value (actually larger) */</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>###字节排序函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#include &lt;sys/_endian.h&gt;</div><div class="line">返回：网络字节序的值</div><div class="line">#define htons(x)	__DARWIN_OSSwapInt16(x)</div><div class="line">#define htonl(x)	__DARWIN_OSSwapInt32(x)</div><div class="line">返回：主机字节序的值</div><div class="line">#define ntohs(x)	__DARWIN_OSSwapInt16(x)</div><div class="line">#define ntohl(x)	__DARWIN_OSSwapInt32(x)</div></pre></td></tr></table></figure></p>
<p>###字节操纵函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#include &lt;strings.h&gt;</div><div class="line">void	 bzero(void *, size_t)</div><div class="line">void	 bcopy(const void *, void *, size_t)</div><div class="line">int	 bcmp(const void *, const void *, size_t)</div></pre></td></tr></table></figure></p>
<p>bzero把目标字节串中指定数目的字节置为0，我们经常使用该函数来把一个套接字地址结构初始化为0。<br>bcopy将指定数目的字节从源字节串复制到目标字节串。<br>bcmp比较两个任意的字节串，若相同则返回值为0，否则返回值为非0。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#include &lt;string.h&gt;</div><div class="line">void	*memset(void *__b, int __c, size_t __len);</div><div class="line">void	*memcpy(void *__dst, const void *__src, size_t __n);</div><div class="line">int	 memcmp(const void *__s1, const void *__s2, size_t __n);</div></pre></td></tr></table></figure>
<p>memset把目标字节串指定数目的字节置为__c。<br>memcpy类似bcopy，不过两个指针参数的顺序是相反的，当源字节串与目标字节串重叠时，bcopy能够正确处理，但是memcpy的操作结果却不可知。<br>memcmp比较两个任意的字节串，若相同则返回0，否则返回一个非0，是大于0还是小于0则取决于第一个不等的字节。</p>
<p>###inet_aton、inet_addr和inet_ntoa函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#include &lt;arpa/inet.h&gt;</div><div class="line">int		 inet_aton(const char *strptr, struct in_addr *addrptr);</div><div class="line">in_addr_t	 inet_addr(const char *strptr);</div><div class="line">char		*inet_ntoa(struct in_addr inaddr);</div></pre></td></tr></table></figure></p>
<p>inet_aton将strptr所指C字符串转换成一个32位的网络字节序二进制值，并通过指针addrptr来存储，若成功则返回1，否这返回0。<br>inet_addr进行相同的转换，返回的值为32位的网络字节序二进制值，出错时返回INADDR_NONE常值。该函数存在一个问题：  255.255.255.255不能有该函数处理，因为它的二进制值用来指示该函数失败。<br>inet_ntoa函数将一个32位的网络二进制IPv4地址转换成相应的点分十进制数串。</p>
<p>###inet_pton和inet_ntop函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#include &lt;arpa/inet.h&gt;</div><div class="line">int		 inet_pton(int family, const char *strptr, void *addrptr);</div><div class="line">const char	*inet_ntop(int family, const void *addrptr, char *strptr, socklen_t len);</div></pre></td></tr></table></figure></p>
<p>inet_pton尝试转换由strptr指针所指的字符串，并通过addrptr指针存放二进制结果。若成功则返回值为1，若输入不是有效的表达格式则为0，若出错则为-1<br>inet_ntop是进行相反的转换，从数值格式（addrptr）转换到表达式（strptr）。len参数是目标存储单元的大小，以免该函数溢出其调用者的缓冲区。为有助于指定这个大小，在头文件中有如下定义：<br><code>#define INET_ADDRSTRLEN 16</code><br><code>#define    INET6_ADDRSTRLEN    46</code><br>如果len太小，不足以容纳表达格式结果（包括结尾的空字符），那么返回一个空指针，并置errno为ENOSPC。<br>inet_ntop函数的strptr参数不可以是一个空指针。调用者必须为目标存储单元分配内存并指定其大小。调用成功时，这个指针就是该函数的返回值。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/12/24/Socket套接字API/" data-id="cix394xkf00002lgtlc0xh79s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Socket/">Socket</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/12/24/iOS自动打包/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">iOS自动打包</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notification/">Notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/">Socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UserNotification/">UserNotification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS10/">iOS10</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/打包/">打包</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Notification/" style="font-size: 20px;">Notification</a> <a href="/tags/Socket/" style="font-size: 10px;">Socket</a> <a href="/tags/UserNotification/" style="font-size: 10px;">UserNotification</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/iOS10/" style="font-size: 20px;">iOS10</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/打包/" style="font-size: 10px;">打包</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/12/24/Socket套接字API/">Socket套接字API</a>
          </li>
        
          <li>
            <a href="/2016/12/24/iOS自动打包/">iOS自动打包</a>
          </li>
        
          <li>
            <a href="/2016/12/24/iOS10-Notification-Content-Extension/">iOS10 Notification Content Extension</a>
          </li>
        
          <li>
            <a href="/2016/12/21/iOS10-Notification-Service-Extension/">iOS10 Notification Service Extension</a>
          </li>
        
          <li>
            <a href="/2016/12/21/iOS10-UserNotification-Framework/">iOS10 UserNotification.Framework</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 MingleChang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>